"use strict";var Ot=Object.create;var j=Object.defineProperty;var Ct=Object.getOwnPropertyDescriptor;var kt=Object.getOwnPropertyNames;var Ht=Object.getPrototypeOf,Mt=Object.prototype.hasOwnProperty;var d=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),qt=(e,t)=>{for(var n in t)j(e,n,{get:t[n],enumerable:!0})},ke=(e,t,n,r)=>{if(t&&typeof t=="object"||typeof t=="function")for(let i of kt(t))!Mt.call(e,i)&&i!==n&&j(e,i,{get:()=>t[i],enumerable:!(r=Ct(t,i))||r.enumerable});return e};var U=(e,t,n)=>(n=e!=null?Ot(Ht(e)):{},ke(t||!e||!e.__esModule?j(n,"default",{value:e,enumerable:!0}):n,e)),Nt=e=>ke(j({},"__esModule",{value:!0}),e);var Ve=d((Nr,ge)=>{typeof Object.create=="function"?ge.exports=function(t,n){n&&(t.super_=n,t.prototype=Object.create(n.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}))}:ge.exports=function(t,n){if(n){t.super_=n;var r=function(){};r.prototype=n.prototype,t.prototype=new r,t.prototype.constructor=t}}});var Je=d((Ar,me)=>{try{if(pe=require("util"),typeof pe.inherits!="function")throw"";me.exports=pe.inherits}catch{me.exports=Ve()}var pe});var Xe=d((zr,we)=>{var Gt=Je(),We=require("events").EventEmitter;we.exports=w;we.exports.default=w;function w(e){if(!(this instanceof w))return new w(e);We.call(this),e=e||{},this.concurrency=e.concurrency||1/0,this.timeout=e.timeout||0,this.autostart=e.autostart||!1,this.results=e.results||null,this.pending=0,this.session=0,this.running=!1,this.jobs=[],this.timers={}}Gt(w,We);var Rt=["pop","shift","indexOf","lastIndexOf"];Rt.forEach(function(e){w.prototype[e]=function(){return Array.prototype[e].apply(this.jobs,arguments)}});w.prototype.slice=function(e,t){return this.jobs=this.jobs.slice(e,t),this};w.prototype.reverse=function(){return this.jobs.reverse(),this};var $t=["push","unshift","splice"];$t.forEach(function(e){w.prototype[e]=function(){var t=Array.prototype[e].apply(this.jobs,arguments);return this.autostart&&this.start(),t}});Object.defineProperty(w.prototype,"length",{get:function(){return this.pending+this.jobs.length}});w.prototype.start=function(e){if(e&&Vt.call(this,e),this.running=!0,this.pending>=this.concurrency)return;if(this.jobs.length===0){this.pending===0&&ve.call(this);return}var t=this,n=this.jobs.shift(),r=!0,i=this.session,o=null,c=!1,f=null,a=n.hasOwnProperty("timeout")?n.timeout:this.timeout;function g(u,y){r&&t.session===i&&(r=!1,t.pending--,o!==null&&(delete t.timers[o],clearTimeout(o)),u?t.emit("error",u,n):c===!1&&(f!==null&&(t.results[f]=Array.prototype.slice.call(arguments,1)),t.emit("success",y,n)),t.session===i&&(t.pending===0&&t.jobs.length===0?ve.call(t):t.running&&t.start()))}a&&(o=setTimeout(function(){c=!0,t.listeners("timeout").length>0?t.emit("timeout",g,n):g()},a),this.timers[o]=o),this.results&&(f=this.results.length,this.results[f]=null),this.pending++,t.emit("start",n);var p=n(g);p&&p.then&&typeof p.then=="function"&&p.then(function(u){return g(null,u)}).catch(function(u){return g(u||!0)}),this.running&&this.jobs.length>0&&this.start()};w.prototype.stop=function(){this.running=!1};w.prototype.end=function(e){Yt.call(this),this.jobs.length=0,this.pending=0,ve.call(this,e)};function Yt(){for(var e in this.timers){var t=this.timers[e];delete this.timers[e],clearTimeout(t)}}function Vt(e){var t=this;this.on("error",n),this.on("end",r);function n(i){t.end(i)}function r(i){t.removeListener("error",n),t.removeListener("end",r),e(i,this.results)}}function ve(e){this.session++,this.running=!1,this.emit("end",e)}});var l=d(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0});s.findBox=s.readUInt=s.readUInt32LE=s.readUInt32BE=s.readInt32LE=s.readUInt24LE=s.readUInt16LE=s.readUInt16BE=s.readInt16LE=s.toHexString=s.toUTF8String=void 0;var Jt=new TextDecoder,Wt=(e,t=0,n=e.length)=>Jt.decode(e.slice(t,n));s.toUTF8String=Wt;var Xt=(e,t=0,n=e.length)=>e.slice(t,n).reduce((r,i)=>r+("0"+i.toString(16)).slice(-2),"");s.toHexString=Xt;var Kt=(e,t=0)=>{let n=e[t]+e[t+1]*256;return n|(n&2**15)*131070};s.readInt16LE=Kt;var Zt=(e,t=0)=>e[t]*2**8+e[t+1];s.readUInt16BE=Zt;var Qt=(e,t=0)=>e[t]+e[t+1]*2**8;s.readUInt16LE=Qt;var en=(e,t=0)=>e[t]+e[t+1]*2**8+e[t+2]*2**16;s.readUInt24LE=en;var tn=(e,t=0)=>e[t]+e[t+1]*2**8+e[t+2]*2**16+(e[t+3]<<24);s.readInt32LE=tn;var nn=(e,t=0)=>e[t]*2**24+e[t+1]*2**16+e[t+2]*2**8+e[t+3];s.readUInt32BE=nn;var rn=(e,t=0)=>e[t]+e[t+1]*2**8+e[t+2]*2**16+e[t+3]*2**24;s.readUInt32LE=rn;var on={readUInt16BE:s.readUInt16BE,readUInt16LE:s.readUInt16LE,readUInt32BE:s.readUInt32BE,readUInt32LE:s.readUInt32LE};function sn(e,t,n,r){n=n||0;let i=r?"BE":"LE",o="readUInt"+t+i;return on[o](e,n)}s.readUInt=sn;function cn(e,t){if(e.length-t<4)return;let n=(0,s.readUInt32BE)(e,t);if(!(e.length-t<n))return{name:(0,s.toUTF8String)(e,4+t,8+t),offset:t,size:n}}function an(e,t,n){for(;n<e.length;){let r=cn(e,n);if(!r)break;if(r.name===t)return r;n+=r.size}}s.findBox=an});var Ke=d(k=>{"use strict";Object.defineProperty(k,"__esModule",{value:!0});k.BMP=void 0;var ye=l();k.BMP={validate:e=>(0,ye.toUTF8String)(e,0,2)==="BM",calculate:e=>({height:Math.abs((0,ye.readInt32LE)(e,22)),width:(0,ye.readUInt32LE)(e,18)})}});var Ie=d(M=>{"use strict";Object.defineProperty(M,"__esModule",{value:!0});M.ICO=void 0;var H=l(),dn=1,un=6,ln=16;function Ze(e,t){let n=e[t];return n===0?256:n}function Qe(e,t){let n=un+t*ln;return{height:Ze(e,n+1),width:Ze(e,n)}}M.ICO={validate(e){let t=(0,H.readUInt16LE)(e,0),n=(0,H.readUInt16LE)(e,4);return t!==0||n===0?!1:(0,H.readUInt16LE)(e,2)===dn},calculate(e){let t=(0,H.readUInt16LE)(e,4),n=Qe(e,0);if(t===1)return n;let r=[n];for(let i=1;i<t;i+=1)r.push(Qe(e,i));return{height:n.height,images:r,width:n.width}}}});var et=d(q=>{"use strict";Object.defineProperty(q,"__esModule",{value:!0});q.CUR=void 0;var hn=Ie(),Ee=l(),fn=2;q.CUR={validate(e){let t=(0,Ee.readUInt16LE)(e,0),n=(0,Ee.readUInt16LE)(e,4);return t!==0||n===0?!1:(0,Ee.readUInt16LE)(e,2)===fn},calculate:e=>hn.ICO.calculate(e)}});var tt=d(N=>{"use strict";Object.defineProperty(N,"__esModule",{value:!0});N.DDS=void 0;var xe=l();N.DDS={validate:e=>(0,xe.readUInt32LE)(e,0)===542327876,calculate:e=>({height:(0,xe.readUInt32LE)(e,12),width:(0,xe.readUInt32LE)(e,16)})}});var nt=d(A=>{"use strict";Object.defineProperty(A,"__esModule",{value:!0});A.GIF=void 0;var _e=l(),gn=/^GIF8[79]a/;A.GIF={validate:e=>gn.test((0,_e.toUTF8String)(e,0,6)),calculate:e=>({height:(0,_e.readUInt16LE)(e,8),width:(0,_e.readUInt16LE)(e,6)})}});var rt=d(z=>{"use strict";Object.defineProperty(z,"__esModule",{value:!0});z.HEIF=void 0;var _=l(),pn={avif:"avif",mif1:"heif",msf1:"heif",heic:"heic",heix:"heic",hevc:"heic",hevx:"heic"};z.HEIF={validate(e){let t=(0,_.toUTF8String)(e,4,8),n=(0,_.toUTF8String)(e,8,12);return t==="ftyp"&&n in pn},calculate(e){let t=(0,_.findBox)(e,"meta",0),n=t&&(0,_.findBox)(e,"iprp",t.offset+12),r=n&&(0,_.findBox)(e,"ipco",n.offset+8),i=r&&(0,_.findBox)(e,"ispe",r.offset+8);if(i)return{height:(0,_.readUInt32BE)(e,i.offset+16),width:(0,_.readUInt32BE)(e,i.offset+12),type:(0,_.toUTF8String)(e,8,12)};throw new TypeError("Invalid HEIF, no size found")}}});var st=d(R=>{"use strict";Object.defineProperty(R,"__esModule",{value:!0});R.ICNS=void 0;var G=l(),mn=8,vn=4,wn=4,yn={ICON:32,"ICN#":32,"icm#":16,icm4:16,icm8:16,"ics#":16,ics4:16,ics8:16,is32:16,s8mk:16,icp4:16,icl4:32,icl8:32,il32:32,l8mk:32,icp5:32,ic11:32,ich4:48,ich8:48,ih32:48,h8mk:48,icp6:64,ic12:32,it32:128,t8mk:128,ic07:128,ic08:256,ic13:256,ic09:512,ic14:512,ic10:1024};function it(e,t){let n=t+wn;return[(0,G.toUTF8String)(e,t,n),(0,G.readUInt32BE)(e,n)]}function ot(e){let t=yn[e];return{width:t,height:t,type:e}}R.ICNS={validate:e=>(0,G.toUTF8String)(e,0,4)==="icns",calculate(e){let t=e.length,n=(0,G.readUInt32BE)(e,vn),r=mn,i=it(e,r),o=ot(i[0]);if(r+=i[1],r===n)return o;let c={height:o.height,images:[o],width:o.width};for(;r<n&&r<t;)i=it(e,r),o=ot(i[0]),r+=i[1],c.images.push(o);return c}}});var ct=d($=>{"use strict";Object.defineProperty($,"__esModule",{value:!0});$.J2C=void 0;var Te=l();$.J2C={validate:e=>(0,Te.toHexString)(e,0,4)==="ff4fff51",calculate:e=>({height:(0,Te.readUInt32BE)(e,12),width:(0,Te.readUInt32BE)(e,8)})}});var at=d(Y=>{"use strict";Object.defineProperty(Y,"__esModule",{value:!0});Y.JP2=void 0;var S=l();Y.JP2={validate(e){if((0,S.readUInt32BE)(e,4)!==1783636e3||(0,S.readUInt32BE)(e,0)<1)return!1;let t=(0,S.findBox)(e,"ftyp",0);return t?(0,S.readUInt32BE)(e,t.offset+4)===1718909296:!1},calculate(e){let t=(0,S.findBox)(e,"jp2h",0),n=t&&(0,S.findBox)(e,"ihdr",t.offset+8);if(n)return{height:(0,S.readUInt32BE)(e,n.offset+8),width:(0,S.readUInt32BE)(e,n.offset+12)};throw new TypeError("Unsupported JPEG 2000 format")}}});var ut=d(V=>{"use strict";Object.defineProperty(V,"__esModule",{value:!0});V.JPG=void 0;var I=l(),In="45786966",En=2,Ue=6,xn=2,_n="4d4d",Tn="4949",dt=12,Un=2;function Sn(e){return(0,I.toHexString)(e,2,6)===In}function bn(e,t){return{height:(0,I.readUInt16BE)(e,t),width:(0,I.readUInt16BE)(e,t+2)}}function Pn(e,t){let r=Ue+8,i=(0,I.readUInt)(e,16,r,t);for(let o=0;o<i;o++){let c=r+Un+o*dt,f=c+dt;if(c>e.length)return;let a=e.slice(c,f);if((0,I.readUInt)(a,16,0,t)===274)return(0,I.readUInt)(a,16,2,t)!==3||(0,I.readUInt)(a,32,4,t)!==1?void 0:(0,I.readUInt)(a,16,8,t)}}function Fn(e,t){let n=e.slice(En,t),r=(0,I.toHexString)(n,Ue,Ue+xn),i=r===_n;if(i||r===Tn)return Pn(n,i)}function Ln(e,t){if(t>e.length)throw new TypeError("Corrupt JPG, exceeded buffer limits")}V.JPG={validate:e=>(0,I.toHexString)(e,0,2)==="ffd8",calculate(e){e=e.slice(4);let t,n;for(;e.length;){let r=(0,I.readUInt16BE)(e,0);if(e[r]!==255){e=e.slice(1);continue}if(Sn(e)&&(t=Fn(e,r)),Ln(e,r),n=e[r+1],n===192||n===193||n===194){let i=bn(e,r+5);return t?{height:i.height,orientation:t,width:i.width}:i}e=e.slice(r+2)}throw new TypeError("Invalid JPG, no size found")}}});var lt=d(J=>{"use strict";Object.defineProperty(J,"__esModule",{value:!0});J.KTX=void 0;var Se=l();J.KTX={validate:e=>{let t=(0,Se.toUTF8String)(e,1,7);return["KTX 11","KTX 20"].includes(t)},calculate:e=>{let t=e[5]===49?"ktx":"ktx2",n=t==="ktx"?36:20;return{height:(0,Se.readUInt32LE)(e,n+4),width:(0,Se.readUInt32LE)(e,n),type:t}}}});var ft=d(W=>{"use strict";Object.defineProperty(W,"__esModule",{value:!0});W.PNG=void 0;var b=l(),Bn=`PNG\r

`,jn="IHDR",ht="CgBI";W.PNG={validate(e){if(Bn===(0,b.toUTF8String)(e,1,8)){let t=(0,b.toUTF8String)(e,12,16);if(t===ht&&(t=(0,b.toUTF8String)(e,28,32)),t!==jn)throw new TypeError("Invalid PNG");return!0}return!1},calculate(e){return(0,b.toUTF8String)(e,12,16)===ht?{height:(0,b.readUInt32BE)(e,36),width:(0,b.readUInt32BE)(e,32)}:{height:(0,b.readUInt32BE)(e,20),width:(0,b.readUInt32BE)(e,16)}}}});var mt=d(X=>{"use strict";Object.defineProperty(X,"__esModule",{value:!0});X.PNM=void 0;var be=l(),gt={P1:"pbm/ascii",P2:"pgm/ascii",P3:"ppm/ascii",P4:"pbm",P5:"pgm",P6:"ppm",P7:"pam",PF:"pfm"},pt={default:e=>{let t=[];for(;e.length>0;){let n=e.shift();if(n[0]!=="#"){t=n.split(" ");break}}if(t.length===2)return{height:parseInt(t[1],10),width:parseInt(t[0],10)};throw new TypeError("Invalid PNM")},pam:e=>{let t={};for(;e.length>0;){let n=e.shift();if(n.length>16||n.charCodeAt(0)>128)continue;let[r,i]=n.split(" ");if(r&&i&&(t[r.toLowerCase()]=parseInt(i,10)),t.height&&t.width)break}if(t.height&&t.width)return{height:t.height,width:t.width};throw new TypeError("Invalid PAM")}};X.PNM={validate:e=>(0,be.toUTF8String)(e,0,2)in gt,calculate(e){let t=(0,be.toUTF8String)(e,0,2),n=gt[t],r=(0,be.toUTF8String)(e,3).split(/[\r\n]+/);return(pt[n]||pt.default)(r)}}});var vt=d(K=>{"use strict";Object.defineProperty(K,"__esModule",{value:!0});K.PSD=void 0;var Pe=l();K.PSD={validate:e=>(0,Pe.toUTF8String)(e,0,4)==="8BPS",calculate:e=>({height:(0,Pe.readUInt32BE)(e,14),width:(0,Pe.readUInt32BE)(e,18)})}});var Et=d(ee=>{"use strict";Object.defineProperty(ee,"__esModule",{value:!0});ee.SVG=void 0;var wt=l(),yt=/<svg\s([^>"']|"[^"]*"|'[^']*')*>/,Z={height:/\sheight=(['"])([^%]+?)\1/,root:yt,viewbox:/\sviewBox=(['"])(.+?)\1/i,width:/\swidth=(['"])([^%]+?)\1/},Fe=2.54,It={in:96,cm:96/Fe,em:16,ex:8,m:96/Fe*100,mm:96/Fe/10,pc:96/72/12,pt:96/72,px:1},Dn=new RegExp(`^([0-9.]+(?:e\\d+)?)(${Object.keys(It).join("|")})?$`);function Q(e){let t=Dn.exec(e);if(t)return Math.round(Number(t[1])*(It[t[2]]||1))}function On(e){let t=e.split(" ");return{height:Q(t[3]),width:Q(t[2])}}function Cn(e){let t=e.match(Z.width),n=e.match(Z.height),r=e.match(Z.viewbox);return{height:n&&Q(n[2]),viewbox:r&&On(r[2]),width:t&&Q(t[2])}}function kn(e){return{height:e.height,width:e.width}}function Hn(e,t){let n=t.width/t.height;return e.width?{height:Math.floor(e.width/n),width:e.width}:e.height?{height:e.height,width:Math.floor(e.height*n)}:{height:t.height,width:t.width}}ee.SVG={validate:e=>yt.test((0,wt.toUTF8String)(e,0,1e3)),calculate(e){let t=(0,wt.toUTF8String)(e).match(Z.root);if(t){let n=Cn(t[0]);if(n.width&&n.height)return kn(n);if(n.viewbox)return Hn(n,n.viewbox)}throw new TypeError("Invalid SVG")}}});var xt=d(ne=>{"use strict";Object.defineProperty(ne,"__esModule",{value:!0});ne.TGA=void 0;var te=l();ne.TGA={validate(e){return(0,te.readUInt16LE)(e,0)===0&&(0,te.readUInt16LE)(e,4)===0},calculate(e){return{height:(0,te.readUInt16LE)(e,14),width:(0,te.readUInt16LE)(e,12)}}}});var _t=d(ie=>{"use strict";Object.defineProperty(ie,"__esModule",{value:!0});ie.TIFF=void 0;var re=require("fs"),P=l();function Mn(e,t,n){let r=(0,P.readUInt)(e,32,4,n),i=1024,o=re.statSync(t).size;r+i>o&&(i=o-r-10);let c=new Uint8Array(i),f=re.openSync(t,"r");return re.readSync(f,c,0,i,r),re.closeSync(f),c.slice(2)}function qn(e,t){let n=(0,P.readUInt)(e,16,8,t);return((0,P.readUInt)(e,16,10,t)<<16)+n}function Nn(e){if(e.length>24)return e.slice(12)}function An(e,t){let n={},r=e;for(;r&&r.length;){let i=(0,P.readUInt)(r,16,0,t),o=(0,P.readUInt)(r,16,2,t),c=(0,P.readUInt)(r,32,4,t);if(i===0)break;c===1&&(o===3||o===4)&&(n[i]=qn(r,t)),r=Nn(r)}return n}function zn(e){let t=(0,P.toUTF8String)(e,0,2);if(t==="II")return"LE";if(t==="MM")return"BE"}var Gn=["49492a00","4d4d002a"];ie.TIFF={validate:e=>Gn.includes((0,P.toHexString)(e,0,4)),calculate(e,t){if(!t)throw new TypeError("Tiff doesn't support buffer");let n=zn(e)==="BE",r=Mn(e,t,n),i=An(r,n),o=i[256],c=i[257];if(!o||!c)throw new TypeError("Invalid Tiff. Missing tags");return{height:c,width:o}}}});var Tt=d(oe=>{"use strict";Object.defineProperty(oe,"__esModule",{value:!0});oe.WEBP=void 0;var T=l();function Rn(e){return{height:1+(0,T.readUInt24LE)(e,7),width:1+(0,T.readUInt24LE)(e,4)}}function $n(e){return{height:1+((e[4]&15)<<10|e[3]<<2|(e[2]&192)>>6),width:1+((e[2]&63)<<8|e[1])}}function Yn(e){return{height:(0,T.readInt16LE)(e,8)&16383,width:(0,T.readInt16LE)(e,6)&16383}}oe.WEBP={validate(e){let t=(0,T.toUTF8String)(e,0,4)==="RIFF",n=(0,T.toUTF8String)(e,8,12)==="WEBP",r=(0,T.toUTF8String)(e,12,15)==="VP8";return t&&n&&r},calculate(e){let t=(0,T.toUTF8String)(e,12,16);if(e=e.slice(20,30),t==="VP8X"){let r=e[0],i=(r&192)===0,o=(r&1)===0;if(i&&o)return Rn(e);throw new TypeError("Invalid WebP")}if(t==="VP8 "&&e[0]!==47)return Yn(e);let n=(0,T.toHexString)(e,3,6);if(t==="VP8L"&&n!=="9d012a")return $n(e);throw new TypeError("Invalid WebP")}}});var Le=d(se=>{"use strict";Object.defineProperty(se,"__esModule",{value:!0});se.typeHandlers=void 0;var Vn=Ke(),Jn=et(),Wn=tt(),Xn=nt(),Kn=rt(),Zn=st(),Qn=Ie(),er=ct(),tr=at(),nr=ut(),rr=lt(),ir=ft(),or=mt(),sr=vt(),cr=Et(),ar=xt(),dr=_t(),ur=Tt();se.typeHandlers={bmp:Vn.BMP,cur:Jn.CUR,dds:Wn.DDS,gif:Xn.GIF,heif:Kn.HEIF,icns:Zn.ICNS,ico:Qn.ICO,j2c:er.J2C,jp2:tr.JP2,jpg:nr.JPG,ktx:rr.KTX,png:ir.PNG,pnm:or.PNM,psd:sr.PSD,svg:cr.SVG,tga:ar.TGA,tiff:dr.TIFF,webp:ur.WEBP}});var St=d(ce=>{"use strict";Object.defineProperty(ce,"__esModule",{value:!0});ce.detector=void 0;var Be=Le(),lr=Object.keys(Be.typeHandlers),Ut={56:"psd",66:"bmp",68:"dds",71:"gif",73:"tiff",77:"tiff",82:"webp",105:"icns",137:"png",255:"jpg"};function hr(e){let t=e[0];if(t in Ut){let r=Ut[t];if(r&&Be.typeHandlers[r].validate(e))return r}let n=r=>Be.typeHandlers[r].validate(e);return lr.find(n)}ce.detector=hr});var Lt=d((m,Ft)=>{"use strict";Object.defineProperty(m,"__esModule",{value:!0});m.types=m.setConcurrency=m.disableTypes=m.disableFS=m.imageSize=void 0;var L=require("fs"),fr=require("path"),gr=Xe(),De=Le(),pr=St(),bt=512*1024,Pt=new gr.default({concurrency:100,autostart:!0}),ae={disabledFS:!1,disabledTypes:[]};function je(e,t){let n=(0,pr.detector)(e);if(typeof n<"u"){if(ae.disabledTypes.indexOf(n)>-1)throw new TypeError("disabled file type: "+n);if(n in De.typeHandlers){let r=De.typeHandlers[n].calculate(e,t);if(r!==void 0)return r.type=r.type??n,r}}throw new TypeError("unsupported file type: "+n+" (file: "+t+")")}async function mr(e){let t=await L.promises.open(e,"r");try{let{size:n}=await t.stat();if(n<=0)throw new Error("Empty file");let r=Math.min(n,bt),i=new Uint8Array(r);return await t.read(i,0,r,0),i}finally{await t.close()}}function vr(e){let t=L.openSync(e,"r");try{let{size:n}=L.fstatSync(t);if(n<=0)throw new Error("Empty file");let r=Math.min(n,bt),i=new Uint8Array(r);return L.readSync(t,i,0,r,0),i}finally{L.closeSync(t)}}Ft.exports=m=Oe;m.default=Oe;function Oe(e,t){if(e instanceof Uint8Array)return je(e);if(typeof e!="string"||ae.disabledFS)throw new TypeError("invalid invocation. input should be a Uint8Array");let n=fr.resolve(e);if(typeof t=="function")Pt.push(()=>mr(n).then(r=>process.nextTick(t,null,je(r,n))).catch(t));else{let r=vr(n);return je(r,n)}}m.imageSize=Oe;var wr=e=>{ae.disabledFS=e};m.disableFS=wr;var yr=e=>{ae.disabledTypes=e};m.disableTypes=yr;var Ir=e=>{Pt.concurrency=e};m.setConcurrency=Ir;m.types=Object.keys(De.typeHandlers)});var Sr={};qt(Sr,{activate:()=>Tr,deactivate:()=>Ur});module.exports=Nt(Sr);var E=U(require("vscode"));var x=U(require("vscode"));var Ae=U(require("vscode")),C=U(require("fs")),fe=U(require("path")),ze=U(require("os"));var h=[];for(let e=0;e<256;++e)h.push((e+256).toString(16).slice(1));function He(e,t=0){return(h[e[t+0]]+h[e[t+1]]+h[e[t+2]]+h[e[t+3]]+"-"+h[e[t+4]]+h[e[t+5]]+"-"+h[e[t+6]]+h[e[t+7]]+"-"+h[e[t+8]]+h[e[t+9]]+"-"+h[e[t+10]]+h[e[t+11]]+h[e[t+12]]+h[e[t+13]]+h[e[t+14]]+h[e[t+15]]).toLowerCase()}var Me=require("crypto"),O=new Uint8Array(256),D=O.length;function ue(){return D>O.length-16&&((0,Me.randomFillSync)(O),D=0),O.slice(D,D+=16)}var qe=require("crypto"),le={randomUUID:qe.randomUUID};function At(e,t,n){if(le.randomUUID&&!t&&!e)return le.randomUUID();e=e||{};let r=e.random||(e.rng||ue)();if(r[6]=r[6]&15|64,r[8]=r[8]&63|128,t){n=n||0;for(let i=0;i<16;++i)t[n+i]=r[i];return t}return He(r)}var he=At;function Ge(e){let t="";return Object.keys(e).map(r=>{if(t=e[r],typeof t=="string"||typeof t=="number")return`${r}: ${t};`}).join(" ")}function Re(){let e=Ae.workspace.getConfiguration("editor"),t=e.get("fontSize")||14,n=e.get("lineHeight")||0,r;return n===0?r=t:n>0&&n<8?r=t*n:r=n,r}var zt=[".gif",".png",".jpg",".jpeg",".svg"],Ne=e=>{let t=ze.default.tmpdir(),n=he(),r=fe.default.join(t,`tmpFile_${n}.svg`);return C.default.writeFileSync(r,e,"utf8"),r},$e=(e,t,n)=>{let r=fe.default.extname(e).toLowerCase();if(!zt.includes(r))throw new Error(`Unsupported image format: ${r}`);try{if(r===".svg"){let g=C.default.readFileSync(e,"utf8").replace(/<svg([^>]*)>/,(p,u)=>`<svg${u+(/<width\s*=\s*["'].*?["']/.test(u)?"":` width="${t}"`)+(/<height\s*=\s*["'].*?["']/.test(u)?"":` height="${n}"`)}>`);return Ne(g)}let o=C.default.readFileSync(e).toString("base64"),c;switch(r){case".gif":c="image/gif";break;case".png":c="image/png";break;case".jpg":case".jpeg":c="image/jpeg";break;default:throw new Error(`Unsupported image format: ${r}`)}let f=`
            <svg xmlns="http://www.w3.org/2000/svg" width="${t}" height="${n}">
                <image href="data:${c};base64,${o}" width="${t}" height="${n}"/>
            </svg>
        `;return Ne(f)}catch(i){throw console.error("An error occurred while processing the icon:",i),new Error(`An error occurred while processing the icon: ${e}`)}};var Ye="resources/panic-icon.gif";var jt=U(Lt());function Ce(e){if(!(x.workspace.getConfiguration().get("rustPanicHighlighter.icon.enabled")??!0))return x.window.createTextEditorDecorationType({});let n=x.workspace.getConfiguration().get("rustPanicHighlighter.icon.path")||"default";n==="default"&&(n=e.asAbsolutePath(Ye));let r=x.workspace.getConfiguration().get("rustPanicHighlighter.icon.size")||64,i=x.workspace.getConfiguration().get("rustPanicHighlighter.icon.adjustTopPosition")||0;if(r!==void 0&&r<=0)throw new Error("icon.size must be a positive number.");let o=`${r}px`,c=`${r}px`,f=$e(n,o,c),a=(0,jt.default)(f),g=x.Uri.file(f),p=Re(),u=a.height??64,y=u<=p?(u-p/4)/2:-((u-p/4)/2);y=y+i;let B={position:"absolute",top:`${y}px`,"z-index":1,"pointer-events":"none"},de=Ge(B);return x.window.createTextEditorDecorationType({after:{contentIconPath:g,textDecoration:`none; ${de}`,margin:"0 1rem"}})}var v=U(require("vscode")),Dt=(a=>(a.unwrap="unwrap(",a.unwrap_unchecked="unwrap_unchecked(",a.unwrap_err="unwrap_err(",a.unwrap_err_unchecked="unwrap_err_unchecked(",a.expect="expect(",a.panic="panic!(",a.todo="todo!(",a.unimplemented="unimplemented!(",a))(Dt||{}),xr={"unwrap(":"This line contains an 'unwrap()', which will panic if the result is None or Err.","unwrap_unchecked(":"This line contains an 'unwrap_unchecked()', which can cause undefined behavior if the result is None or Err.","unwrap_err(":"This line contains an 'unwrap_err()', which will panic if the result is Ok.","unwrap_err_unchecked(":"This line contains an 'unwrap_err_unchecked()', which can cause undefined behavior if the result is Ok.","expect(":"This line contains an 'expect()', which will panic if the result is None or Err.","panic!(":"This line contains a 'panic!' which can cause a runtime panic.","todo!(":"This line contains a 'todo!' macro, which is a placeholder and will panic if executed.","unimplemented!(":"This line contains an 'unimplemented!' macro, which will panic if executed."};function F(e,t,n){if(e.languageId!=="rust")return;let r=v.workspace.getConfiguration().get("rustPanicHighlighter.diagnostic.ignoredPanics",[]),i=[],o=v.window.activeTextEditor,c=[],f=_r();for(let a=0;a<e.lineCount;a++){let g=e.lineAt(a);if(g.text.trimStart().startsWith("//"))continue;let p=null;for(let[u,y]of Object.entries(Dt))if(!r.includes(u.toLowerCase())&&g.text.includes(y)){p=y;break}if(p){let u=xr[p],y=g.text.indexOf(p),B=new v.Range(a,y,a,g.text.length);c.push(B);let de=new v.Diagnostic(B,u,f);i.push(de)}}o&&o.setDecorations(n,c),i.length===0?t.delete(e.uri):t.set(e.uri,i)}function _r(){let e=v.workspace.getConfiguration().get("rustPanicHighlighter.diagnostic.severity"),t;switch(e){case"Error":t=v.DiagnosticSeverity.Error;break;case"Information":t=v.DiagnosticSeverity.Information;break;case"Hint":t=v.DiagnosticSeverity.Hint;break;case"Warning":default:t=v.DiagnosticSeverity.Warning;break}return t}function Tr(e){let t=E.languages.createDiagnosticCollection("rust-panic-highlighter");e.subscriptions.push(t);let n=Ce(e);e.subscriptions.push(n),E.workspace.textDocuments.forEach(r=>{r.languageId==="rust"&&F(r,t,n)}),E.workspace.onDidOpenTextDocument(r=>{r.languageId==="rust"&&F(r,t,n)}),E.workspace.onDidChangeTextDocument(r=>{r.document.languageId==="rust"&&F(r.document,t,n)}),E.workspace.onDidCloseTextDocument(r=>{r.languageId==="rust"&&t.delete(r.uri)}),E.window.onDidChangeActiveTextEditor(r=>{r&&r.document.languageId==="rust"&&F(r.document,t,n)}),E.workspace.onDidChangeConfiguration(r=>{r.affectsConfiguration("rustPanicHighlighter")&&(n.dispose(),n=Ce(e),e.subscriptions.push(n),E.workspace.textDocuments.forEach(i=>{i.languageId==="rust"&&F(i,t,n)}))})}function Ur(){}0&&(module.exports={activate,deactivate});
